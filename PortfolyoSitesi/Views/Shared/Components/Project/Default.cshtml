@model List<PortfolyoSitesi.Data.Project>

@{
	Layout = null;
}

<div class="projects-grid isotope-container row">
    @foreach (var item in Model)
    {
        <div class="isotope-item col-md-6 col-lg-4 p-3 cat-@item.CategoryId">
            <div class="project-card" style="margin: 0;">
                <div class="project-image">
                    @if (!string.IsNullOrEmpty(item.ImageUrl))
                    {
                        <img src="@item.ImageUrl"
                             alt="@item.ProjectName"
                             style="width: 100%; height: 100%; object-fit: cover;" />
                    }
                    else
                    {
                        <span>🏪</span>
                    }
                </div>

                <div class="project-info">
                    <h3>@item.ProjectName</h3>
                    <p>@item.Title</p>

                    <div class="project-tags">
                        <span class="tag">@item.Category?.CategoryName</span>
                    </div>

                    @if (!string.IsNullOrEmpty(item.ProjectLink))
                    {
                        <a href="@item.ProjectLink"
                           class="btn btn-sm btn-outline-primary mt-3"
                           target="_blank"
                           rel="noopener">
                            Projeyi İncele
                        </a>
                    }
                </div>
            </div>
        </div>
    }
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        console.log("Portfolio Filter Script Initializing...");
        
        // Wait a bit for the main script to finish
        setTimeout(function() {
            var $grid = $('.isotope-container');
            if ($grid.length === 0) {
                console.error("Isotope container not found!");
                return;
            }

            // Ensure Isotope is initialized
            if (!$grid.data('isotope')) {
                console.log("Initializing Isotope manually...");
                $grid.isotope({
                    itemSelector: '.isotope-item',
                    layoutMode: 'masonry'
                });
            }

            // Bind filter click
            $('.isotope-filter').on('click', 'a', function(e) {
                e.preventDefault();
                var filterValue = $(this).attr('data-filter');
                console.log("Filtering by: " + filterValue);
                
                $grid.isotope({ filter: filterValue });
                
                // Active class update
                $('.isotope-filter a').removeClass('active');
                $(this).addClass('active');
            });
            
            console.log("Portfolio Filter Script Ready.");
        }, 1000);
    });
</script>
</section>